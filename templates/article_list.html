{% extends "base.html" %}

{% block title %}
Articles
{% endblock title %}

{% block content %}
<br>
{% for article in article_list %}
<div class="card border-dark mb-3" style="max-width: 100rem;">
  
  <!-- 游릴 Card Header -->
  <div class="card-header d-flex justify-content-between align-items-center">
    <div>
      <a href="{% url 'article_detail' pk=article.pk %}">{{ article.title }}</a>
      <span class="text-muted">&middot; by {{ article.author }} | {{ article.date }}</span>
    </div>
    
    {% if article.author.pk == request.user.pk %}
    <div>
      <a href="{% url 'article_edit' pk=article.pk %}" class="me-2 text-decoration-none">Edit</a>
      <span class="text-muted">/</span>
      <a href="{% url 'article_delete' pk=article.pk %}" class="ms-2 text-decoration-none text-danger">Delete</a>
    </div>
    {% endif %}
  </div>

  <!-- 游릴 Card Body -->
  <div class="card-body">
    {{ article.body }}
  </div>

  <!-- 游릴 Card Footer (Comments Section) -->
  <div class="card-footer bg-light">
    {% if article.comment_set.all %}
      <h6 class="text-muted mb-2">Comments</h6>
      <ul class="list-unstyled mb-0">
        {% for comment in article.comment_set.all %}
          <li class="mb-2">
            <strong>{{ comment.author }}</strong>
            <span class="text-muted"> &middot; {{ comment }}</span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-muted mb-2"><em>No comments yet.</em></p>
    {% endif %}

    <!-- 游릭 New Comment link -->
    <div class="text-end mt-2">
      <a href="{{ article.get_absolute_url }}" class="text-decoration-none fw-semibold">+ New Comment</a>
    </div>
  </div>
</div>
{% endfor %}
{% endblock content %}
